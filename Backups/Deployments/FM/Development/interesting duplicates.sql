/*2 min runtime*/

--SELECT
--	CS_Lookup_Melissa_Address_Mapping_to_CLT00001.ALLCLMROWID,
--	COUNT(*)
--FROM
--	dbo.CS_Lookup_Melissa_Address_Mapping_to_CLT00001
--GROUP BY
--	CS_Lookup_Melissa_Address_Mapping_to_CLT00001.ALLCLMROWID
--HAVING
--	COUNT(*)> 1
USE ClaimSearch
DECLARE @allClmRowId VARCHAR(1000) = '1020100041201602090302103631'

SELECT *
FROM dbo.CS_Lookup_Melissa_Address_Mapping_to_CLT00001 WITH(NOLOCK)
WHERE
	CS_Lookup_Melissa_Address_Mapping_to_CLT00001.ALLCLMROWID = @allClmRowId

SELECT *
FROM dbo.CS_Lookup_Unique_Addresses_Melissa_Output WITH (NOLOCK)
WHERE 
	CS_Lookup_Unique_Addresses_Melissa_Output.AddressKey IN
	(
		SELECT CS_Lookup_Melissa_Address_Mapping_to_CLT00001.AddressKey
		FROM dbo.CS_Lookup_Melissa_Address_Mapping_to_CLT00001 WITH(NOLOCK)
		WHERE
			CS_Lookup_Melissa_Address_Mapping_to_CLT00001.ALLCLMROWID = @allClmRowId
	)

SELECT *
FROM ClaimSearch_Prod.dbo.CLT00001 WITH(NOLOCK)
WHERE
	CLT00001.ALLCLMROWID = @allClmRowId
	
	
	
/*
ALLCLMROWID	(No column name)
										1020100041201602090302103631	2
										1020100041201812030233714076	2
										1020100041201812020302497884	2
										1020100041201708310303241257	2
1020100041201602100402265359	2
1020100041201602090302311459	2
1020100041201602100402382762	2
102010004120160214050348326	2
1020100041201602150303225316	2
1020100041201602170302270631	2
102010004120160211040318182	2
102010004120160212054317527	2
1020100041201602100402402450	2
1020100041201602290304143652	2
1020100041201602110403239043	2
102010004120160229030496862	2
102010004120160220040216226	2
1020100041201602110403270545	2
102010004120160216030212679	2
102010004120160208031710645	2
1020100041201602230402425511	2
1020100041201708260302206954	2
102010004120160210040218015	2
102010004120160213030216148	2
1020100041201602180302264543	2
1020100041201602180302189442	2
*/

--SELECT
--	*
--FROM	
--	dbo.CLT00001
--WHERE
--	CLT00001.ALLCLMROWID IN
--	(
--															'1020100041201812020302497884',
--													'1020100041201812030233714076',
--															'1020100041201602090302103631',
--		'1020100041201602100402265359',
--		'1020100041201602090302311459',
--		'1020100041201602100402382762',
--		'102010004120160214050348326',
--		'1020100041201602150303225316',
--		'1020100041201602170302270631',
--		'102010004120160211040318182',
--		'102010004120160212054317527',
--		'1020100041201602100402402450',
--		'1020100041201602290304143652',
--		'1020100041201602110403239043',
--		'102010004120160229030496862',
--		'102010004120160220040216226',
--		'1020100041201602110403270545',
--		'102010004120160216030212679',
--		'102010004120160208031710645',
--		'1020100041201602230402425511',
--		'1020100041201708260302206954',
--		'102010004120160210040218015',
--		'102010004120160213030216148',
--		'1020100041201602180302264543',
--		'1020100041201708310303241257',
--		'1020100041201602180302189442'
--	)	