--SELECT TOP 3 * FROM CDP.X_NENT_by_SSN_max
--SELECT TOP 3 * FROM CDP.X_NENT_by_SSN_max_tp
--SELECT TOP 3 * FROM CDP.X_NENT_NSSN_max
--SELECT TOP 3 * FROM CDP.X_NENT_NSSN_max_tp
--SELECT TOP 3 * FROM CDP.X_NSSN_SSNEnt_max_tp

--SELECT COUNT(*), I_ALLCLM FROM CDP.X_NENT_by_SSN_max GROUP BY I_ALLCLM HAVING COUNT(*)>1
--SELECT COUNT(*), I_ALLCLM FROM CDP.X_NENT_by_SSN_max_tp GROUP BY I_ALLCLM HAVING COUNT(*)>1
--SELECT COUNT(*), I_ALLCLM FROM CDP.X_NENT_NSSN_max GROUP BY I_ALLCLM HAVING COUNT(*)>1
--SELECT COUNT(*), I_ALLCLM FROM CDP.X_NENT_NSSN_max_tp GROUP BY I_ALLCLM HAVING COUNT(*)>1
--SELECT COUNT(*), I_ALLCLM FROM CDP.X_NSSN_SSNEnt_max_tp GROUP BY I_ALLCLM HAVING COUNT(*)>1

--6S004499769
DECLARE @I_ALLCLM VARCHAR(11) ='0B004814887' 

DECLARE @DateFilter3Year INT = CAST(
	REPLACE(
		CAST(
			CAST(
				DATEADD(
					YEAR,
					-3,
					GETDATE()
				)
			AS DATE)
		AS CHAR(10)),
		'-',
		''
	)
AS INT);

SELECT * FROM CDP.X_NENT_by_SSN_max WHERE I_ALLCLM = @I_ALLCLM
SELECT * FROM CDP.X_NENT_by_SSN_max_tp WHERE I_ALLCLM = @I_ALLCLM
SELECT * FROM CDP.X_NENT_NSSN_max WHERE I_ALLCLM = @I_ALLCLM
SELECT * FROM CDP.X_NENT_NSSN_max_tp WHERE I_ALLCLM = @I_ALLCLM
SELECT * FROM CDP.X_NSSN_SSNEnt_max_tp WHERE I_ALLCLM = @I_ALLCLM
SELECT * FROM CDP.F_SSN_multiENT WHERE I_ALLCLM = @I_ALLCLM
SELECT DISTINCT * FROM CDP.FS_PA_Matching_SSN WHERE I_ALLCLM = @I_ALLCLM
and Date_Insert_MTCH >=@DateFilter3Year

SELECT
F_SSN_multiENT,
X_NSSN_SSNEnt_max_tp,
*
FROM
CDP.FS_PA_Matching_All
WHERE
FS_PA_Matching_All.F_SSN_multiENT = 1

'

--IN (
'0I004899927',
'6F004537456',
'2L004734654',
'8Z004886404',
'2W004589490',
'8H004562552',
'8G004640777',
'2U004558088',
'5S004585043',
'1W004626519',
'8I004619435',
'6E004515301',
'6Z004871957'
)
ORDER BY I_ALLCLM
SELECT
	I_ALLCLM,
	COUNT(DISTINCT I_NM_ADR)
FROM
CDP.FS_PA_Matching_SSN
GROUP BY
	I_ALLCLM
HAVING COUNT(DISTINCT I_NM_ADR)>1
I_ALLCLM
0C004606922


SELECT * FROM CDP.X_NENT_by_SSN_max
WHERE
	I_ALLCLM IN (
'0I004899927',
'6F004537456',
'2L004734654',
'8Z004886404',
'2W004589490',
'8H004562552',
'8G004640777',
'2U004558088',
'5S004585043',
'1W004626519',
'8I004619435',
'6E004515301',
'6Z004871957'
)

ORDER BY I_ALLCLM

3R004568946
1S004538061
3T004887808
3S004878249
8I004841340

CDP.X_NSSN_SSNEnt_max_tp = #25
